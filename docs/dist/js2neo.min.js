!function(){function w(){}function v(o){var n=[],i=0;function t(n){var t=i;return i+=n,t}function e(n){for(var t="",e=i+n;i<e;i++)t+=String.fromCharCode(o.getUint8(i));return t}function r(n){for(var t=[],e=0;e<n;e++)t.push(s());return t}function a(n){for(var t={},e=0;e<n;e++){t[s()]=s()}return t}function s(){var n=o.getUint8(i++);return n<128?n:n<144?e(n-128):n<160?r(n-144):n<176?a(n-160):n<192?function(n){for(var t=o.getUint8(i++),e=[],r=0;r<n;r++)e.push(s());return new p(t,e)}(n-176):n<193?null:n<194?o.getFloat64(t(8)):n<196?!!(1&n):n<200?void 0:n<201?o.getInt8(t(1)):n<202?o.getInt16(t(2)):n<203?o.getInt32(t(4)):n<204?[o.getUint32(t(4)),o.getUint32(t(4))]:n<208?void 0:n<209?e(o.getUint8(i++)):n<210?e(o.getUint16(t(2))):n<211?e(o.getUint32(t(4))):n<212?void 0:n<213?r(o.getUint8(i++)):n<214?r(o.getUint16(t(2))):n<215?r(o.getUint32(t(4))):n<216?void 0:n<217?a(o.getUint8(i++)):n<218?a(o.getUint16(t(2))):n<219?a(o.getUint32(t(4))):n<240?void 0:n-256}for(;i<o.byteLength;)n.push(s());return n}function p(n,t){this.tag=n,this.fields=t||[]}function C(n){for(var t=new Uint8Array(n.length),e=0;e<n.length;e++)t[e]=n.charCodeAt(e);return t.buffer}function U(n,t){this.message=n,this.handler=t}function t(n){n=n||{};var e={userAgent:"js2neo/1.0.0-alpha.0",url:("https:"===document.location.protocol?"wss":"ws")+"://"+(n.host||"localhost")+":"+(n.port||7687),user:n.user||"neo4j"},t={scheme:"basic",principal:e.user,credentials:n.password||"password"},o=new Uint8Array(2),i={},a=[],s=[],r=n.onConnect||w;function u(){i.inData="",i.inChunks=[],i.ready=!1,i.socket=new WebSocket(e.url),i.socket.binaryType="arraybuffer",i.socket.onmessage=h,i.socket.onerror=n.onError||w,i.socket.onclose=n.onClose||w,i.socket.onopen=function(){f(new Uint8Array([96,96,176,23,0,0,0,2,0,0,0,1,0,0,0,0,0,0,0,0]))},a.push(new U(new p(1,[e.userAgent,t]),{112:function(){i.ready=!0},127:c}))}function f(n){i.socket.send(n)}function c(n){i.socket.close(1002,n.code+": "+n.message),u()}function g(){function n(n,t){o[0]=n,o[1]=t,f(o)}for(;0<a.length;){var t=a.shift(),e=(r=t.message,i=void 0,i="",function n(t){var e,r;if(null===t)i+="À";else if("string"==typeof t)(r=t.length)<16?i+=String.fromCharCode(128+r)+t:r<256?i+="Ð"+String.fromCharCode(r)+t:r<65536&&(i+="Ñ"+String.fromCharCode(r>>8)+String.fromCharCode(255&r)+t);else if(t instanceof p)for(i+=String.fromCharCode(176+t.fields.length,t.tag),e=0;e<t.fields.length;e++)n(t.fields[e]);else{var o=Object.getOwnPropertyNames(t);for(i+=String.fromCharCode(160+o.length),e=0;e<o.length;e++)n(o[e]),n(t[o[e]])}}(r),i);for(s.push(t.handler);32767<e.length;)n(127,255),f(C(e.substr(0,32767))),e=e.substr(32767);n(e.length>>8,255&e.length),f(C(e)),n(0,0)}var r,i}function h(n){var t=new DataView(n.data);e.protocolVersion=t.getInt32(0,!1),r(e),i.socket.onmessage=d,g()}function l(n){var t,e,r,o=i.inChunks;""===n?(t=C(o.join()),e=v(new DataView(t))[0],r=113===e.tag?s[0]:s.shift(),127===e.tag&&a.push(new U(new p(14),{127:c})),r&&(r[e.tag]||w)(e.fields[0]),i.inChunks=[]):o.push(n)}function d(n){i.inData+=function(n){for(var t=new DataView(n),e="",r=0;r<t.byteLength;r++)e+=String.fromCharCode(t.getUint8(r));return e}(n.data);for(var t=!0;t;){var e=2+(256*i.inData.charCodeAt(0)+i.inData.charCodeAt(1));i.inData.length>=e?(l(i.inData.slice(2,e)),i.inData=i.inData.substr(e)):t=!1}}this.run=function(n){var t=n.cypher;0<t.length&&(a.push(new U(new p(16,[t,n.parameters||{}]),{112:n.onHeader||w,127:n.onFailure||w})),a.push(new U(new p(63),{112:n.onFooter||w,113:n.onRecord||w,127:n.onFailure||w}))),i.ready&&g()},u()}window.js2neo={bolt:function(n){return new t(n)}}}();