// js2neo v1.0.0-beta.1 © 2018 Nigel Small
// Licensed under the Apache License, Version 2.0
!function(n){var e="days",t="id",o="nanoseconds",r="properties",i="seconds",v=String.fromCharCode,j=DataView,l=Uint8Array,f=Math.min;function w(){}function s(n){for(var e=0;e<n.length;e++)this[arguments[e+1]]=n[e]}function h(n){for(var e=new l(n.length),t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e.buffer}n.js2neo={open:function(n){return new a(n)},Node:function(n){s.call(this,n,t,"labels",r)},Relationship:function(n){s.call(this,n,t,"start","end","type",r)},Path:function(n){var e,t,o,r,i=n[0],s=n[1],a=n[2],u=i[0],c=[u],l=js2neo.Relationship;for(t=0;t<a.length;t+=2)o=a[t],e=i[a[2*t+1]],0<o?(r=s[o-1],c.push(new l([r.id,u.id,e.id,r.type,r.properties]))):(r=s[s.length+o],c.push(new l([r.id,e.id,u.id,r.type,r.properties]))),c.push(e),u=e;this.entities=c},Point:function(n){s.call(this,n,"srid","x","y")},Date:function(n){s.call(this,n,e)},Time:function(n){this.seconds=n[0]/1e9,this.tz=n[1]},LocalTime:function(n){this.seconds=n[0]/1e9},DateTime:function(n){s.call(this,n,i,o,"tz")},LocalDateTime:function(n){s.call(this,n,i,o)},Duration:function(n){s.call(this,n,"months",e,i,o)},version:"1.0.0-beta.1"};var y={68:js2neo.Date,69:js2neo.Duration,70:js2neo.DateTime,78:js2neo.Node,80:js2neo.Path,82:js2neo.Relationship,84:js2neo.Time,88:js2neo.Point,100:js2neo.LocalDateTime,102:js2neo.DateTime,114:function(n){s.call(this,n,t,"type",r)},116:js2neo.LocalTime};function a(t){var o={secure:(t=t||{}).secure||"https:"===document.location.protocol,user:t.user||"neo4j",host:t.host||"localhost",port:t.port||7687,userAgent:t.userAgent||"js2neo/"+js2neo.version},n={scheme:"basic",principal:o.user,credentials:t.password},s={inData:"",inChunks:[],ready:!1,socket:new WebSocket((o.secure?"wss":"ws")+"://"+o.host+":"+o.port)},p=s.socket,d=[[1,[o.userAgent,n],{112:function(){(t.onInit||w)(o),s.ready=!0},127:t.onInitFailure}]],g=[];function r(n){p.send(n)}function i(){for(;0<d.length;){var n=d.shift(),i=v(176+n[1].length,n[0]),e=0;function s(n){return v(n>>24)+v(n>>16&255)+v(n>>8&255)+v(255&n)}function a(n){var e=new l(8);new j(e.buffer).setFloat64(0,n,!1),i+="Á"+v.apply(null,e)}function u(n,e,t,o){return n=f(n,2147483647),i+=n<16?v(e+n):n<65536?t+v(n>>8)+v(255&n):o+s(n),n}function c(n){var e,t,o;if(Array.isArray(n))for(e=u(n.length,144,"Õ","Ö"),t=0;t<e;t++)c(n[t]);else{var r=typeof n;"boolean"===r?i+=n?"Ã":"Â":"number"===r?n%1==0?-16<=(o=n)&&o<128?i+=v((256+o)%256):-32768<=o&&o<32768?i+="É"+v(o>>8)+v(255&o):-2147483648<=o&&o<2147483648?i+="Ê"+s(o):a(o):a(n):"string"===r?(e=u(n.length,128,"Ñ","Ò"),i+=n.substr(0,e)):"object"===r?function(n){for(var e,t=Object.getOwnPropertyNames(n),o=u(t.length,160,"Ù","Ú"),r=0;r<o;r++)c(e=t[r]),c(n[e])}(n):i+="À"}}for(n[1].forEach(c),g.push(n[2]);i=i.substr(e),e=f(i.length,32767),r(h(v(e>>8,255&e)+i.substr(0,e))),i;);}}function a(n){var o=new j(n),r=0;function i(){return o.getUint8(r++)}function s(){return r+=2,o.getUint16(r-2,!1)}function a(){return r+=4,o.getUint16(r-4,!1)}function u(n){for(var e="",t=r+n;r<t;)e+=v(i());return e}function c(n){for(var e=[];n--;)e.push(t());return e}function l(n){for(var e={};n--;){e[t()]=t()}return e}function f(n){for(var e=[i()];n--;)e.push(t());return e}function t(){var n,e,t=i();return t<128?t:t<144?u(t-128):t<160?c(t-144):t<176?l(t-160):t<192?(n=f(t-176),(e=y[n[0]])?new e(n.slice(1)):n):t<193?null:t<194?(r+=8,o.getFloat64(r-8,!1)):t<196?!!(1&t):t<200?void 0:t<201?o.getInt8(r++):t<202?(r+=2,o.getInt16(r-2,!1)):t<203?(r+=4,o.getInt32(r-4,!1)):t<204?function(){var n=o.getUint32(r,!1).toString(16),e=o.getUint32(r+4,!1).toString(16);for(r+=8;n.length<8;)n="0"+n;for(;e.length<8;)e="0"+e;return parseInt("0x"+n+e,16)}():t<208?void 0:t<209?u(i()):t<210?u(s()):t<211?u(a()):t<212?void 0:t<213?c(i()):t<214?c(s()):t<215?c(a()):t<216?void 0:t<217?l(i()):t<218?l(s()):t<219?l(a()):t<240?void 0:t-256}var e=f(i()-176),h=113===e[0]?g[0]:g.shift();127===e[0]&&d.push([14,[],{127:function(n){p.close(4002,n.code+": "+n.message)}}]),h&&(h[e[0]]||w)(e[1])}function u(n){for(var e,t,o=1,r=s.inData+=v.apply(null,new l(n.data)),i=s.inChunks;o;)e=2+(r.charCodeAt(0)<<8|r.charCodeAt(1)),r.length>=e?(""===(t=r.slice(2,e))?(a(h(i.join())),i=s.inChunks=[]):i.push(t),r=s.inData=s.inData.substr(e)):o=0}p.binaryType="arraybuffer",p.onmessage=function(n){var e=new j(n.data);o.protocolVersion=e.getInt32(0,!1),(t.onHandshake||w)(o),p.onmessage=u,i()},p.onerror=t.onError,p.onclose=t.onClose,p.onopen=function(){(t.onOpen||w)(o),r(new l([96,96,176,23,0,0,0,2,0,0,0,1,0,0,0,0,0,0,0,0]))},this.run=function(n,e,t){0<n.length&&(d.push([16,[n,e||{}],{112:t.onHeader,127:t.onFailure}]),d.push([63,[],{112:t.onFooter,113:t.onRecord,127:t.onFailure}])),s.ready&&i()},this.close=function(){p.close()}}console.log("js2neo v"+n.js2neo.version)}("undefined"!=typeof window?window:global);
