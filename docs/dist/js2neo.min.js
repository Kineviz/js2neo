!function(){function l(){}function h(n){var o="";function s(n){var e,t;if(null===n)o+="À";else if("string"==typeof n)(t=n.length)<16?o+=String.fromCharCode(128+t)+n:t<256?o+="Ð"+String.fromCharCode(t)+n:t<65536&&(o+="Ñ"+String.fromCharCode(t>>8)+String.fromCharCode(255&t)+n);else if(n instanceof w)for(o+=String.fromCharCode(176+n.fields.length,n.tag),e=0;e<n.fields.length;e++)s(n.fields[e]);else{var r=Object.getOwnPropertyNames(n);for(o+=String.fromCharCode(160+r.length),e=0;e<r.length;e++)s(r[e]),s(n[r[e]])}}for(var e=0;e<n.length;e++)s(n[e]);return o}function d(o){var n=[],s=0;function e(n){var e=s;return s+=n,e}function t(n){for(var e="",t=s+n;s<t;s++)e+=String.fromCharCode(o.getUint8(s));return e}function r(n){for(var e=[],t=0;t<n;t++)e.push(a());return e}function i(n){for(var e={},t=0;t<n;t++){e[a()]=a()}return e}function a(){var n=o.getUint8(s++);return n<128?n:n<144?t(n-128):n<160?r(n-144):n<176?i(n-160):n<192?function(n){for(var e=o.getUint8(s++),t=[],r=0;r<n;r++)t.push(a());return new w(e,t)}(n-176):n<193?null:n<194?o.getFloat64(e(8)):n<196?!!(1&n):n<200?void 0:n<201?o.getInt8(e(1)):n<202?o.getInt16(e(2)):n<203?o.getInt32(e(4)):n<204?[o.getUint32(e(4)),o.getUint32(e(4))]:n<208?void 0:n<209?t(o.getUint8(s++)):n<210?t(o.getUint16(e(2))):n<211?t(o.getUint32(e(4))):n<212?void 0:n<213?r(o.getUint8(s++)):n<214?r(o.getUint16(e(2))):n<215?r(o.getUint32(e(4))):n<216?void 0:n<217?i(o.getUint8(s++)):n<218?i(o.getUint16(e(2))):n<219?i(o.getUint32(e(4))):n<240?void 0:n-256}for(;s<o.byteLength;)n.push(a());return n}function w(n,e){this.tag=n,this.fields=e}function p(n){for(var e=new Uint8Array(n.length),t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e.buffer}function v(n,e){this.message=n,this.handler=e}function e(n){n=n||{};var s=this,e=("https:"===document.location.protocol?"wss":"ws")+"://"+(n.host||"localhost")+":"+(n.port||7687),t={url:e,user:n.user||"neo4j"},r=[new v(new w(1,["js2neo/1.0.0-alpha.0",{scheme:"basic",principal:t.user,credentials:n.password||"password"}]),{112:console.log,127:console.log})],i=[],o=[],a=n.onConnect||l;function f(){for(;0<r.length;){var n=r.shift();i.push(n.handler);for(var e=h([n.message]);32767<e.length;)s.socket.send(new Uint8Array([127,255])),s.socket.send(p(e.substr(0,32767))),e=e.substr(32767);s.socket.send(new Uint8Array([e.length>>8,255&e.length])),s.socket.send(p(e)),s.socket.send(new Uint8Array([0,0]))}}function u(n){var e,t,r,o;""===n?(e=p(s.chunkInputBuffer.join()),r=d(new DataView(e))[0],(o=113===r.tag?i[0]:i.shift())&&(t=o[r.tag])&&t(r.fields[0]),s.chunkInputBuffer=[]):s.chunkInputBuffer.push(n)}function c(n){s.rawInputBuffer+=function(n){for(var e=new DataView(n),t="",r=0;r<e.byteLength;r++)t+=String.fromCharCode(e.getUint8(r));return t}(n.data);for(var e=!0;e;){var t=2+(256*s.rawInputBuffer.charCodeAt(0)+s.rawInputBuffer.charCodeAt(1));s.rawInputBuffer.length>=t?(u(s.rawInputBuffer.slice(2,t)),s.rawInputBuffer=s.rawInputBuffer.substr(t)):e=!1}}function g(n){console.log(JSON.stringify(n));var e=new v(new w(14,[]),{112:console.log,127:console.log});r.push(e)}s.rawInputBuffer="",s.chunkInputBuffer=[],s.socket=new WebSocket(e),s.socket.binaryType="arraybuffer",s.ready=!1,s.socket.onmessage=function(n){var e=new DataView(n.data);t.protocolVersion=e.getInt32(0,!1),a(t),s.socket.onmessage=c,f(),s.ready=!0},s.socket.onerror=console.log,s.socket.onclose=console.log,s.socket.onopen=function(){s.socket.send(new Uint8Array([96,96,176,23,0,0,0,2,0,0,0,1,0,0,0,0,0,0,0,0]))},s.protocolVersion=null,s.run=function(e){o.push(new Date);var n=e.cypher;0<n.length&&(r.push(new v(new w(16,[n,e.parameters||{}]),{112:e.onHeader||console.log,127:g})),r.push(new v(new w(63,[]),{112:function(n){n.time=new Date-o.shift()+"ms",(e.onFooter||console.log)(n)},113:e.onRecord||console.log,127:g}))),s.ready&&f()}}window.js2neo={bolt:function(n){return new e(n)}}}();