!function(){function w(){}function v(n){var o="";function i(n){var t,e;if(null===n)o+="À";else if("string"==typeof n)(e=n.length)<16?o+=String.fromCharCode(128+e)+n:e<256?o+="Ð"+String.fromCharCode(e)+n:e<65536&&(o+="Ñ"+String.fromCharCode(e>>8)+String.fromCharCode(255&e)+n);else if(n instanceof p)for(o+=String.fromCharCode(176+n.fields.length,n.tag),t=0;t<n.fields.length;t++)i(n.fields[t]);else{var r=Object.getOwnPropertyNames(n);for(o+=String.fromCharCode(160+r.length),t=0;t<r.length;t++)i(r[t]),i(n[r[t]])}}for(var t=0;t<n.length;t++)i(n[t]);return o}function C(o){var n=[],i=0;function t(n){var t=i;return i+=n,t}function e(n){for(var t="",e=i+n;i<e;i++)t+=String.fromCharCode(o.getUint8(i));return t}function r(n){for(var t=[],e=0;e<n;e++)t.push(s());return t}function a(n){for(var t={},e=0;e<n;e++){t[s()]=s()}return t}function s(){var n=o.getUint8(i++);return n<128?n:n<144?e(n-128):n<160?r(n-144):n<176?a(n-160):n<192?function(n){for(var t=o.getUint8(i++),e=[],r=0;r<n;r++)e.push(s());return new p(t,e)}(n-176):n<193?null:n<194?o.getFloat64(t(8)):n<196?!!(1&n):n<200?void 0:n<201?o.getInt8(t(1)):n<202?o.getInt16(t(2)):n<203?o.getInt32(t(4)):n<204?[o.getUint32(t(4)),o.getUint32(t(4))]:n<208?void 0:n<209?e(o.getUint8(i++)):n<210?e(o.getUint16(t(2))):n<211?e(o.getUint32(t(4))):n<212?void 0:n<213?r(o.getUint8(i++)):n<214?r(o.getUint16(t(2))):n<215?r(o.getUint32(t(4))):n<216?void 0:n<217?a(o.getUint8(i++)):n<218?a(o.getUint16(t(2))):n<219?a(o.getUint32(t(4))):n<240?void 0:n-256}for(;i<o.byteLength;)n.push(s());return n}function p(n,t){this.tag=n,this.fields=t||[]}function U(n){for(var t=new Uint8Array(n.length),e=0;e<n.length;e++)t[e]=n.charCodeAt(e);return t.buffer}function m(n,t){this.message=n,this.handler=t}function t(n){n=n||{};var e={userAgent:"js2neo/1.0.0-alpha.0",url:("https:"===document.location.protocol?"wss":"ws")+"://"+(n.host||"localhost")+":"+(n.port||7687),user:n.user||"neo4j"},t={scheme:"basic",principal:e.user,credentials:n.password||"password"},r=new Uint8Array(2),o={},i=[],a=[],s=n.onConnect||w;function u(){o.inData="",o.inChunks=[],o.ready=!1,o.socket=new WebSocket(e.url),o.socket.binaryType="arraybuffer",o.socket.onmessage=h,o.socket.onerror=n.onError||w,o.socket.onclose=n.onClose||w,o.socket.onopen=function(){f(new Uint8Array([96,96,176,23,0,0,0,2,0,0,0,1,0,0,0,0,0,0,0,0]))},i.push(new m(new p(1,[e.userAgent,t]),{112:function(){o.ready=!0},127:c}))}function f(n){o.socket.send(n)}function c(n){o.socket.close(1002,n.code+": "+n.message),u()}function g(){function n(n,t){r[0]=n,r[1]=t,f(r)}for(;0<i.length;){var t=i.shift(),e=v([t.message]);for(a.push(t.handler);32767<e.length;)n(127,255),f(U(e.substr(0,32767))),e=e.substr(32767);n(e.length>>8,255&e.length),f(U(e)),n(0,0)}}function h(n){var t=new DataView(n.data);e.protocolVersion=t.getInt32(0,!1),s(e),o.socket.onmessage=d,g()}function l(n){var t,e,r;""===n?(t=U(o.inChunks.join()),e=C(new DataView(t))[0],r=113===e.tag?a[0]:a.shift(),127===e.tag&&i.push(new m(new p(14),{127:c})),r&&(r[e.tag]||w)(e.fields[0]),o.inChunks=[]):o.inChunks.push(n)}function d(n){o.inData+=function(n){for(var t=new DataView(n),e="",r=0;r<t.byteLength;r++)e+=String.fromCharCode(t.getUint8(r));return e}(n.data);for(var t=!0;t;){var e=2+(256*o.inData.charCodeAt(0)+o.inData.charCodeAt(1));o.inData.length>=e?(l(o.inData.slice(2,e)),o.inData=o.inData.substr(e)):t=!1}}this.run=function(n){var t=n.cypher;0<t.length&&(i.push(new m(new p(16,[t,n.parameters||{}]),{112:n.onHeader||w,127:n.onFailure||w})),i.push(new m(new p(63),{112:n.onFooter||w,113:n.onRecord||w,127:n.onFailure||w}))),o.ready&&g()},u()}window.js2neo={bolt:function(n){return new t(n)}}}();