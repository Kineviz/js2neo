!function(){var u=Uint8Array;function t(e){var o=String.fromCharCode,s="";function a(e){var n,t;if(null===e)s+="À";else if("string"==typeof e)(t=e.length)<16?s+=o(128+t)+e:t<256?s+="Ð"+o(t)+e:t<65536&&(s+="Ñ"+o(t>>8)+o(255&t)+e);else if(e instanceof f)for(s+=o(176+e.fields.length,e.tag),n=0;n<e.fields.length;n++)a(e.fields[n]);else{var r=Object.getOwnPropertyNames(e);for(s+=o(160+r.length),n=0;n<r.length;n++)a(r[n]),a(e[r[n]])}}for(var n=0;n<e.length;n++)a(e[n]);return s}function c(o){var e=[],s=0;function n(e){var n=o.substr(s,e);return s+=e,n}function a(){var e=o.charCodeAt(s++);return 192===e?null:194!==e&&(195===e||(0<=e&&e<=127?e:128<=e&&e<=143?n(e-128):144<=e&&e<=159?function(e){for(var n=[],t=0;t<e;t++)n.push(a());return n}(e-144):160<=e&&e<=175?function(e){for(var n={},t=0;t<e;t++)n[a()]=a();return n}(e-160):176<=e&&e<=191?function(e){for(var n=o.charCodeAt(s++),t=[],r=0;r<e;r++)t.push(a());return new f(n,t)}(e-176):208===e?n(o.charCodeAt(s++)):240<=e&&e<=255?e-256:void console.log(e)))}for(;s<o.length;)e.push(a());return e}function f(e,n){this.tag=e,this.fields=n,this.toString=function(){return"Structure<"+this.tag+">("+JSON.stringify(this.fields)+")"}}function l(e){for(var n=new u(e.length),t=0;t<e.length;t++)n[t]=e.charCodeAt(t);return n}function i(e,n){this.message=e,this.handler=n}function n(e){var o=this;e=e||{},o.socket=new WebSocket("ws://"+(e.host||"localhost")+":"+(e.port||7687)),o.socket.binaryType="arraybuffer",o.rawInputBuffer="",o.chunkInputBuffer=[],o.requests=[],o.handlers=[],o.ready=!1;var n=new i(new f(1,["js2neo/1.0.0-alpha.0",{scheme:"basic",principal:e.user||"neo4j",credentials:e.password||"password"}]),{112:console.log,113:console.log,126:console.log,127:console.log});function s(){for(;0<o.requests.length;){var e=o.requests.shift();o.handlers.push(e.handler),console.log("C: "+e.message);for(var n=t([e.message]);32767<n.length;)o.socket.send(new u([127,255])),o.socket.send(l(n.substr(0,32767))),n=n.substr(32767);o.socket.send(new u([n.length>>8,255&n.length])),o.socket.send(l(n)),o.socket.send(new u([0,0]))}}function r(e){var n,t;""===e?(n=o.chunkInputBuffer.join(),(113===(t=c(n)[0]).tag?o.handlers[0]:o.handlers.shift())[t.tag](t.fields[0]),o.chunkInputBuffer=[]):o.chunkInputBuffer.push(e)}function a(e){o.rawInputBuffer+=function(e){for(var n=new DataView(e),t="",r=0;r<n.byteLength;r++)t+=String.fromCharCode(n.getUint8(r));return t}(e.data);for(var n=!0;n;){var t=2+(256*o.rawInputBuffer.charCodeAt(0)+o.rawInputBuffer.charCodeAt(1));o.rawInputBuffer.length>=t?(r(o.rawInputBuffer.slice(2,t)),o.rawInputBuffer=o.rawInputBuffer.substr(t)):n=!1}}o.requests.push(n),o.socket.addEventListener("message",function e(n){o.socket.removeEventListener("message",e);var t=new DataView(n.data);o.protocolVersion=t.getInt32(0,!1),console.log("Using protocol version "+o.protocolVersion),o.socket.addEventListener("message",a),s(),o.ready=!0}),o.socket.addEventListener("open",function(e){var n=new u([96,96,176,23]),t=new DataView(new ArrayBuffer(16));t.setInt32(0,2,!1),t.setInt32(4,1,!1),o.socket.send(n),o.socket.send(t)}),o.socket.addEventListener("error",function(e){console.log(e)}),o.socket.addEventListener("close",function(e){console.log(e)}),o.protocolVersion=null,o.run=function(e){var n=e.cypher;if(0<n.length){var t=new i(new f(16,[n,e.parameters||{}]),{112:console.log,113:console.log,126:console.log,127:console.log}),r=new i(new f(63,[]),{112:console.log,113:console.log,126:console.log,127:console.log});o.requests.push(t),o.requests.push(r)}o.ready&&s()}}window.js2neo={graph:function(e){return new n(e)}}}();
